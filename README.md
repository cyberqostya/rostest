# my_doctors — Плагин для WordPress

Кастомный тип записей **Доктор** с таксономиями, мета-полями, архивом и фильтрацией.

---

## Развернуть проект локально

- Клонировать репозиторий `git clone https://github.com/cyberqostya/rostest`
- Скачать WordPress development tool https://localwp.com/
- Установить, используя стандартные шаги
- Запустить приложение Local
- Создать новый сайт (admin admin admin@test.local)
- Нажать в приложении Local на `Site Folder` , должна открыться папка по примерному пути `C:\Users\Имя\Local Sites\Имя сайта`
- Файлы из гита поместить:
- - Плагин: скопировать папку `my_doctors` в папку `/app/public/wp-content/plugins`
- - Тема: скопировать файлы `single-doctors.php` и `archive-doctors.php` в папку `/app/public/wp-content/themes/Имя темы` (использовал стандартную twentytwentyfive)
- - Данные: в админ-панели Tools → Import → WordPress → Install now → Run Importer → `data.xml` → **Обязательно галочку `Download and import file attachments` для картинок** или создать вручную в админ-панели
- - Картинки докторов (необязательно): скопировать содержимое папки `uploads` в папку `/app/public/wp-content/uploads` или задать вручную каждому доктору в админ-панели
- Нажать в приложении Local на `Open site`
- Активировать тему и плагин в админке
- Перейти на /doctors/ для тестирования

## URL для проверки

- Архив врачей: `/doctors/`
- Одиночная запись: `/doctors/имя-врача/`

## Краткие описания

- Используем создание своего плагина чтобы кастомные типы записей, таксономии и логика не зависели от темы Wordpress.
- Специализация hierarchical - в медицине есть общие направления и узкие подкатегории.
- Город — non-hierarchical, проще для админке (не будет большого количества чекбоксов (тк городов может быть много)), а также структура Страна-Регион-Город не нужна и обычно поиск врачей идет по конкретной точке
- Не используем ACF (для развития :) )
- Поставил ограничение на сохранение в таблицу значений мета данных выходящих за рамки "разумного" (php)

- Структура:

```
  my_doctors/
  ├─ my_doctors.php // основной файл плагина
  ├─ includes/
  │ ├─ cpt-doctors.php // регистрация CPT
  │ ├─ taxonomies.php // регистрация таксономий
  │ ├─ meta-fields.php // мета-поля
  │ └─ query-modifiers.php // пагинация, фильтры, сортировка
  ├─ assets/
  │ └─ css
  │ └─ style.css // мини стили верстки
  data.xml // экспорт данных сайта (медиа + доктора)
  single-doctors.php // шаблон записи
  archive-doctors.php // шаблон архива
  README.md // инструкция
  uploads/ // картинки докторов, тк Export отдает только .xml
```

## Задел на будущее

- Красивыые стили css
- JS для сообщений в админке при вводе неправильного значения мета полей
- Склонения вывода данных "Стаж: 2 лет, 1 лет, итд"
- Рейтинг в звездах рисовать
- Добавить в карточку архива если специализации больше 2х логику "и еще 2"
- Умная ссылка "назад" при фильтрации и возврате обратно в архив
- Ajax запросы без нажатия на кнопку "Применить" фильтра с задержкой ввода данных во избежании многочисленных запросов
